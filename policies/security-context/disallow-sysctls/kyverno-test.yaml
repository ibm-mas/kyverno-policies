apiVersion: cli.kyverno.io/v1alpha1
kind: Test
metadata:
  name: disallow-sysctls
policies:
  - disallow-sysctls.yaml
resources:
  - resources.yaml
results:
  ###### Pods - Bad
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - badpod01
    kind: Pod
    result: fail
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - badpod02
    kind: Pod
    result: fail
  ###### Pods - Good
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodpod01
    kind: Pod
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodpod02
    kind: Pod
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodpod03
    kind: Pod
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodpod04
    kind: Pod
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodpod05
    kind: Pod
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodpod06
    kind: Pod
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodpod07
    kind: Pod
    result: pass
  ###### Deployments - Bad
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - baddeployment01
    kind: Deployment
    result: fail
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - baddeployment02
    kind: Deployment
    result: fail
  ###### Deployments - Good
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - gooddeployment01
    kind: Deployment
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - gooddeployment02
    kind: Deployment
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - gooddeployment03
    kind: Deployment
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - gooddeployment04
    kind: Deployment
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - gooddeployment05
    kind: Deployment
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - gooddeployment06
    kind: Deployment
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - gooddeployment07
    kind: Deployment
    result: pass
  ###### CronJobs - Bad
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - badcronjob01
    kind: CronJob
    result: fail
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - badcronjob02
    kind: CronJob
    result: fail
  ###### CronJobs - Good
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodcronjob01
    kind: CronJob
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodcronjob02
    kind: CronJob
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodcronjob03
    kind: CronJob
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodcronjob04
    kind: CronJob
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodcronjob05
    kind: CronJob
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodcronjob06
    kind: CronJob
    result: pass
  - policy: mas-disallow-sysctls
    rule: check-sysctls
    resources:
      - goodcronjob07
    kind: CronJob
    result: pass
